import{G as B}from"./constants.fe8bda37.js";import{c as M,u as j,n as x,q as O,m as V,a as H}from"./index.21ff19c6.js";import{u as W}from"./ScrollTo.81bea8a7.js";import{u as T}from"./SeoSiteScore.27f85b41.js";import{j as F,n as G}from"./helpers.a0b389be.js";import{C as q,a as J}from"./Score.4a6ae984.js";import{o as n,c as m,H as p,m as y,l as v,v as Y,u as h,q as U,a as d,J as K,t as S,y as L,b as f,g as Q,x as l,G as X,N as Z}from"./runtime-dom.esm-bundler.c4caba60.js";import{p as $}from"./popup.92105c51.js";import{C as ee}from"./Blur.63f260fa.js";import{C as I}from"./Card.ca14447d.js";import{u as te}from"./ConnectStore.6172826b.js";import{i as oe,_ as se}from"./iphone-frame.8d933d9e.js";import{g as re}from"./utils.c2c3e058.js";import{C as ne}from"./DonutChartWithLegend.9312ebff.js";import{S as ie}from"./Refresh.a1c1c9a1.js";import"./translations.d159963e.js";import{_ as P}from"./_plugin-vue_export-helper.eefbdd86.js";import{_ as c,s as w}from"./default-i18n.20001971.js";import{S as ae}from"./index.f3c7a985.js";import"./params.af7ed354.js";import"./Tooltip.e12834fc.js";import"./Caret.cc16468c.js";import"./Slide.9bb3b45e.js";import"./SetupWizardStore.2f8477b8.js";import"./SchemaStore.e1c60a5d.js";import"./metabox.c14c3439.js";import"./cleanForSlug.cacc99d0.js";import"./toString.1e64e8a6.js";import"./contentHasAssets.e1428256.js";import"./_baseSet.ca702273.js";import"./regex.8a6101c0.js";import"./GoogleSearchPreview.bb846430.js";import"./Url.58e6efcb.js";import"./Information.efebd14c.js";import"./DonutChart.36f89ed8.js";import"./AnimatedNumber.f40bef48.js";import"./numbers.9fc174f3.js";import"./Loading.62cbc7c3.js";const le={key:0,class:"aioseo-seo-site-score-cta"},ce={__name:"CompetitorSiteHeader",setup(e){const{connectWithAioseo:t,strings:o}=T(),s=M(),r=j(),i=a=>{$(a,t,600,630,!0,["token"],C,()=>{})},z=te(),C=a=>z.saveConnectToken(a.token);return(a,A)=>(n(),m("div",null,[p(h(I),{slug:"analyzeNewCompetitor","hide-header":"","no-slide":"",toggles:!1},{default:y(()=>[(n(),v(Y(h(s).internalOptions.internal.siteAnalysis.connectToken?"div":h(ee)),null,{default:y(()=>[U(a.$slots,"default")]),_:3})),h(s).internalOptions.internal.siteAnalysis.connectToken?f("",!0):(n(),m("div",le,[d("a",{href:"#",onClick:A[0]||(A[0]=K(R=>i(h(r).aioseo.urls.connect),["prevent"]))},S(h(t)),1),L(" "+S(h(o).toAnalyzeCompetitorSite),1)]))]),_:3}),h(s).internalOptions.internal.siteAnalysis.connectToken?U(a.$slots,"competitor-results",{key:0}):f("",!0)]))}},b="all-in-one-seo-pack",me={setup(e){const{description:t,strings:o}=T({score:Q(e.score)});return{analyzerStore:x(),composableStrings:o,description:t,iphoneFrame:oe,getAssetUrl:F}},components:{CoreDonutChartWithLegend:ne,SvgRefresh:ie},props:{score:Number,loading:Boolean,site:{type:String,required:!0},summary:{type:Object,default(){return{}}},mobileSnapshot:String},data(){return{isAnalyzing:!1,strings:O(this.composableStrings,{refreshResults:c("Refresh Results",b),mobileSnapshot:c("Mobile Snapshot",b),analyzing:c("Analyzing...",b)})}},computed:{sortedParts(){const e=this.summary.good||0,t=this.summary.recommended||0,o=this.summary.critical||0,s=e+t+o;return re({good:e,warnings:t,issues:o,total:s},"competitor",!1)}},methods:{refresh(){this.isAnalyzing=!0,this.analyzerStore.runSiteAnalyzer({url:this.site,refresh:!0}).then(()=>{this.isAnalyzing=!1,this.$emit("refresh")})}}},pe={class:"aioseo-site-score-competitor"},ue={class:"aioseo-seo-site-score-score"},he={key:0,class:"mobile-snapshot"},ye={class:"mobile-snapshot-image"},de=["src"],ge=["src"];function _e(e,t,o,s,r,i){const z=l("core-donut-chart-with-legend"),C=l("svg-refresh"),a=l("base-button");return n(),m("div",pe,[d("div",ue,[p(z,{parts:i.sortedParts,total:parseInt(o.score),label:s.description,maxTotal:"100",loading:r.isAnalyzing||o.loading,loadingText:r.strings.analyzing},null,8,["parts","total","label","loading","loadingText"])]),p(a,{class:"refresh-results",type:"gray",size:"small",onClick:i.refresh,loading:r.isAnalyzing},{default:y(()=>[p(C),L(" "+S(r.strings.refreshResults),1)]),_:1},8,["onClick","loading"]),o.mobileSnapshot?(n(),m("div",he,[d("div",null,S(r.strings.mobileSnapshot),1),d("div",ye,[d("img",{class:"mobile-snapshot-image__frame",src:s.getAssetUrl(s.iphoneFrame),alt:"Mobile Snapshot iPhone Frame"},null,8,de),d("img",{class:"mobile-snapshot-image__content",alt:"Mobile Snapshot",src:o.mobileSnapshot},null,8,ge)])])):f("",!0)])}const fe=P(me,[["render",_e]]),_="all-in-one-seo-pack",Se={setup(){const{strings:e}=T(),{scrollTo:t}=W();return{analyzerStore:x(),settingsStore:V(),composableStrings:e,scrollTo:t}},components:{CoreAnalyze:q,CoreAnalyzeScore:J,CoreAnalyzeCompetitorSiteHeader:ce,CoreCard:I,CoreSeoSiteAnalysisResults:se,CoreSiteScoreCompetitor:fe,SvgTrash:ae},data(){return{competitorUrl:null,isAnalyzing:!1,inputError:!1,competitorResults:{},analyzeTime:8,strings:O(this.composableStrings,{enterCompetitorUrl:c("Enter Competitor URL",_),performInDepthAnalysis:c("Perform in-depth SEO Analysis of your competitor's website.",_),analyze:c("Analyze",_),pleaseEnterValidUrl:c("Please enter a valid URL.",_)})}},watch:{"analyzerStore.analyzeError"(e){e&&(this.isAnalyzing=!1)}},computed:{getError(){switch(this.analyzerStore.analyzeError){case"invalid-url":return c("The URL provided is invalid.",_);case"missing-content":return w("%1$s %2$s",c("We were unable to parse the content for this site.",_),H.getDocLink(B.learnMore,"seoAnalyzerIssues",!0));case"invalid-token":return w(c("Your site is not connected. Please connect to %1$s, then try again.",_),"AIOSEO")}return this.analyzerStore.analyzeError}},methods:{getSummary(e){return{recommended:this.analyzerStore.recommendedCount("competitor",e),critical:this.analyzerStore.criticalCount("competitor",e),good:this.analyzerStore.goodCount("competitor",e)}},startAnalyzing(e){if(this.inputError=!1,this.competitorUrl=e,!this.competitorUrl.startsWith("http://")&&!this.competitorUrl.startsWith("https")&&(this.competitorUrl="https://"+this.competitorUrl),!G(this.competitorUrl)){this.inputError=!0;return}this.analyzerStore.analyzeError=!1,this.analyzerStore.runSiteAnalyzer({url:this.competitorUrl}),this.isAnalyzing=!0,setTimeout(this.checkStatus,this.analyzeTime*1e3),this.closeAllCards()},checkStatus(){if(this.isAnalyzing=!1,this.analyzerStore.analyzing){this.$nextTick(()=>{this.isAnalyzing=!0,2>this.analyzeTime&&(this.analyzeTime=8),this.analyzeTime=this.analyzeTime/2,setTimeout(this.checkStatus,this.analyzeTime*1e3)});return}this.$nextTick(async()=>{this.competitorResults=await this.analyzerStore.getCompetitorSiteAnalysisResults();const e=Object.keys(this.competitorResults),t=e.indexOf(this.competitorUrl)===-1?0:e.indexOf(this.competitorUrl);this.toggleCard(t),this.scrollTo("aioseo-competitor-results"+this.hashCode(e[t])),this.competitorUrl=null})},startDeleteSite(e){this.closeAllCards(),delete this.competitorResults[e],this.analyzerStore.deleteCompetitorSite(e)},closeAllCards(){Object.keys(this.competitorResults).forEach(t=>{this.settingsStore.closeCard("analyzeCompetitorSite"+t)})},toggleCard(e){const t=Object.keys(this.competitorResults);this.settingsStore.toggleCard({slug:"analyzeCompetitorSite"+t[e]})},hashCode(e){if(!e)return;let t=0,o,s;for(o=0;o<e.length;o++)s=e.charCodeAt(o),t=(t<<5)-t+s,t|=0;return t},async refresh(){this.competitorResults=await this.analyzerStore.getCompetitorSiteAnalysisResults()}},async mounted(){var t,o;this.analyzerStore.analyzeError=!1,this.competitorResults=this.analyzerStore.competitors;const e=Object.keys(this.competitorResults);(o=(t=this.settingsStore)==null?void 0:t.settings)!=null&&o.toggledCards[`analyzeCompetitorSite${e[0]}`]||this.toggleCard(0)}},ze={class:"aioseo-analyze-competitor-site"},Ce={key:0,class:"aioseo-description aioseo-error"},Ae=["innerHTML"],ke={class:"competitor-results-main"},be={key:0,class:"competitor-results-body"};function ve(e,t,o,s,r,i){const z=l("core-analyze"),C=l("core-analyze-score"),a=l("svg-trash"),A=l("core-site-score-competitor"),R=l("core-seo-site-analysis-results"),D=l("core-card"),N=l("core-analyze-competitor-site-header");return n(),m("div",ze,[p(N,null,{"competitor-results":y(()=>[(n(!0),m(X,null,Z(r.competitorResults,(g,u)=>(n(),v(D,{key:u,id:"aioseo-competitor-results"+i.hashCode(u),slug:"analyzeCompetitorSite"+u,"save-toggle-status":!1,class:"aioseo-competitor-results-wrapper"},{header:y(()=>[p(C,{score:parseInt(g.score)},null,8,["score"]),d("span",null,S(u),1),r.isAnalyzing?f("",!0):(n(),v(a,{key:0,onClick:k=>i.startDeleteSite(u)},null,8,["onClick"]))]),default:y(()=>{var k,E;return[d("div",ke,[p(A,{site:u,score:parseInt(g.score),loading:s.analyzerStore.analyzing,summary:i.getSummary(u),"mobile-snapshot":(E=(k=g.results)==null?void 0:k.advanced)==null?void 0:E.mobileSnapshot,onRefresh:i.refresh},null,8,["site","score","loading","summary","mobile-snapshot","onRefresh"]),g!=null&&g.results?(n(),m("div",be,[p(R,{section:"all",site:u,"all-results":g.results,"show-google-preview":""},null,8,["site","all-results"])])):f("",!0)])]}),_:2},1032,["id","slug"]))),128))]),default:y(()=>[p(z,{header:r.strings.enterCompetitorUrl,description:r.strings.performInDepthAnalysis,inputError:r.inputError,isAnalyzing:r.isAnalyzing,analyzeTime:r.analyzeTime,placeholder:"https://competitorwebsite.com",onStartAnalyzing:i.startAnalyzing},{errors:y(()=>[r.inputError?(n(),m("div",Ce,S(r.strings.pleaseEnterValidUrl),1)):f("",!0),s.analyzerStore.analyzer==="competitor-site"&&s.analyzerStore.analyzeError?(n(),m("div",{key:1,class:"analyze-errors aioseo-description aioseo-error",innerHTML:s.analyzerStore.analyzeError},null,8,Ae)):f("",!0)]),_:1},8,["header","description","inputError","isAnalyzing","analyzeTime","onStartAnalyzing"])]),_:1})])}const mt=P(Se,[["render",ve]]);export{mt as default};
